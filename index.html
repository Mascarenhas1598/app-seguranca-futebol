<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Segurança em Eventos</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">

  <div id="login" class="max-w-md mx-auto mt-20 bg-white p-8 rounded-xl shadow-md">
    <img id="logoEmpresa" src="./logo_nm_engenharia.jpg" alt="Logo NM Engenharia" class="mx-auto mb-6 w-40">
    <h2 class="text-2xl font-bold text-center mb-4">Acesso Restrito</h2>
    <label for="usuario" class="block font-semibold">Usuário</label>
    <input type="text" id="usuario" class="w-full p-2 border border-gray-300 rounded mb-4">
    <label for="senha" class="block font-semibold">Senha</label>
    <input type="password" id="senha" class="w-full p-2 border border-gray-300 rounded mb-6">
    <button id="entrar" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 w-full">Entrar</button>
  </div>

  <div id="app" class="hidden max-w-6xl mx-auto p-6 space-y-10">

    <!-- Ajuda Geral -->
    <section class="bg-yellow-100 border-l-4 border-yellow-500 p-4 rounded">
      <h2 class="text-lg font-bold mb-2 text-yellow-800">Ajuda Geral</h2>
      <ul class="list-disc list-inside text-sm text-yellow-700">
        <li>Preencha os campos obrigatórios de forma clara e objetiva.</li>
        <li>Utilize os valores entre 0 e 1 nas análises conforme a legenda apresentada.</li>
        <li>Faça o upload de fotos com descrição detalhada em cada fase do evento.</li>
        <li>Registre apenas ocorrências reais, com dados verificados.</li>
        <li>Use a previsão de risco com IA como suporte à tomada de decisão.</li>
        <li>Ao final, utilize a função de exportar para gerar seu relatório em PDF.</li>
      </ul>
    </section>

    <!-- Cadastro de Partida -->
<section class="bg-white p-6 rounded shadow">
  <h2 class="text-xl font-bold mb-4">Cadastro da Partida</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
      <label class="block font-semibold">Data</label>
      <input type="date" class="w-full p-2 border rounded">
    </div>
    <div>
      <label class="block font-semibold">Horário</label>
      <input type="time" class="w-full p-2 border rounded">
    </div>
    <div class="md:col-span-2">
      <label class="block font-semibold">Equipes Envolvidas</label>
      <input type="text" id="equipesEnvolvidas" class="w-full p-2 border rounded">
    </div>
    <div>
      <div>
      <label class="block font-semibold">Local de Interesse</label>
      <input type="text" class="w-full p-2 border rounded">
    </div>
    <div>
      <label class="block font-semibold">Capacidade Habilitada do Local</label>
      <input type="number" class="w-full p-2 border rounded">
    </div>
    </div>
  </div>
</section>

<!-- Análise de Risco -->
<section class="bg-white p-6 rounded shadow">
  <div class="mb-4 p-4 bg-blue-50 border-l-4 border-blue-400 text-sm text-blue-700">
    <p><strong>Legenda dos Campos "0 a 1":</strong></p>
    <ul class="list-disc list-inside">
      <li><strong>0</strong> = Condição ideal ou risco nulo</li>
      <li><strong>0.5</strong> = Situação intermediária ou risco moderado</li>
      <li><strong>1</strong> = Condição crítica ou alto risco</li>
    </ul>
  </div>
  <h2 class="text-xl font-bold mb-4">Análise de Risco</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
    <div>
      <label class="block font-semibold">Nível de Treinamento da Equipe de Segurança</label>
      <input type="number" id="treinamentoSeguranca" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Tempo de Inspeção Prévia do Estádio</label>
      <input type="number" id="tempoInspecao" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Eficiência dos Checkpoints</label>
      <input type="number" id="eficienciaCheckpoints" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Condição das Vias de Acesso</label>
      <input type="number" id="condicaoVias" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Iluminação Pública no Entorno</label>
      <input type="number" id="iluminacaoPublica" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Distância até Apoio Policial</label>
      <input type="number" id="distanciaApoioPolicial" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Dia da Semana (0=Segunda, 1=Domingo ou feriado)</label>
      <input type="number" id="diaSemana" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Histórico Emocional do Confronto</label>
      <input type="number" id="historicoEmocional" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Monitoramento de Grupos Organizados</label>
      <input type="number" id="monitoramentoGrupos" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
    <div>
      <label class="block font-semibold">Mandados de Prisão Pendentes</label>
      <input type="number" id="mandadosPendentes" class="w-full p-2 border rounded" placeholder="0 a 1">
    </div>
  </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">Efetivo Empregado</label>
          <input type="number" id="fatorEfetivo" class="w-full p-2 border rounded">
        </div>
        <div>
          <label class="block font-semibold">Número de Ocorrências</label>
          <input type="number" id="fatorOcorrencias" class="w-full p-2 border rounded">
        </div>
        <div>
          <label class="block font-semibold">Clima</label>
          <input type="number" id="clima" class="w-full p-2 border rounded" placeholder="0 a 1">
        </div>
        <div>
          <label class="block font-semibold">Rivalidade</label>
          <input type="number" id="rivalidade" class="w-full p-2 border rounded" placeholder="0 a 1">
        </div>
        <div>
          <label class="block font-semibold">Torcida Visitante</label>
          <input type="number" id="visitante" class="w-full p-2 border rounded" placeholder="0 a 1">
        </div>
        <div>
          <label class="block font-semibold">Infraestrutura</label>
          <input type="number" id="infraestrutura" class="w-full p-2 border rounded" placeholder="0 a 1">
        </div>
        <div>
          <label class="block font-semibold">Evacuação</label>
          <input type="number" id="evacuacao" class="w-full p-2 border rounded" placeholder="0 a 1">
        </div>
      </div>
      <button onclick="preverRiscoIA()" class="mt-6 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">Prever Risco com IA</button>
      <p id="resultadoIA" class="mt-4 font-bold"></p>
    </section>

    <!-- Relatório Fotográfico -->
    <section class="bg-white p-6 rounded shadow">
  <h2 class="text-xl font-bold mb-4">Relatório Fotográfico</h2>
  <div class="mb-4 p-4 bg-green-50 border-l-4 border-green-400 text-sm text-green-700">
    <p><strong>Instruções:</strong> envie até 5 fotos por fase do evento (Montagem, Entrada, Jogo, Evacuação, Fechamento). Cada imagem deve ter uma descrição clara do que está sendo registrado.</p>
  </div>
  <div class="space-y-4">
    <label class="block font-semibold">Fase do Evento</label>
    <select class="w-full p-2 border rounded">
      <option value="Montagem">Montagem</option>
      <option value="Entrada">Entrada</option>
      <option value="Jogo">Jogo</option>
      <option value="Evacuação">Evacuação</option>
      <option value="Fechamento">Fechamento</option>
    </select>
        <label class="block font-semibold">Upload de Fotos (até 5 por fase)</label>
        <input type="file" multiple class="w-full p-2 border rounded">
        <label class="block font-semibold">Descrição da Foto</label>
        <input type="text" maxlength="200" class="w-full p-2 border rounded">
      </div>
    </section>

    <!-- Registro de Ocorrências -->
    <section class="bg-white p-6 rounded shadow">
      <h2 class="text-xl font-bold mb-4">Registro de Ocorrências</h2>
      <div class="mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 text-sm text-yellow-700">
        <p><strong>Orientação:</strong> descreva apenas ocorrências reais, com o máximo de detalhes possíveis (local, horário, tipo e consequências).</p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block font-semibold">Tipo de Ocorrência</label>
          <input type="text" class="w-full p-2 border rounded">
        </div>
        <div>
          <label class="block font-semibold">Local</label>
          <input type="text" class="w-full p-2 border rounded">
        </div>
        <div>
          <label class="block font-semibold">Horário</label>
          <input type="time" class="w-full p-2 border rounded">
        </div>
        <div class="md:col-span-2">
          <label class="block font-semibold">Descrição</label>
          <textarea class="w-full p-2 border rounded"></textarea>
        </div>
      </div>
    </section>

    <!-- Exportar Relatório -->
    <section class="bg-white p-6 rounded shadow">
      <h2 class="text-xl font-bold mb-4">Exportar Relatório</h2>
      <button onclick="window.print()" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">Exportar para PDF</button>
    </section>

  </div>
<script>
document.getElementById("entrar").addEventListener("click", function () {
  document.getElementById("login").style.display = "none";
  document.getElementById("app").classList.remove("hidden");
});
function preverRiscoIA() {
  const publico = parseFloat(document.getElementById('fatorPublico')?.value || 0);
  const efetivo = parseFloat(document.getElementById('fatorEfetivo')?.value || 0);
  const ocorrencias = parseFloat(document.getElementById('fatorOcorrencias')?.value || 0);
  const clima = parseFloat(document.getElementById('clima')?.value || 0);
  const rivalidade = parseFloat(document.getElementById('rivalidade')?.value || 0);
  const visitante = parseFloat(document.getElementById('visitante')?.value || 0);
  const infra = parseFloat(document.getElementById('infraestrutura')?.value || 0);
  const evacuacao = parseFloat(document.getElementById('evacuacao')?.value || 0);
  const tempoResposta = parseFloat(document.getElementById('tempoResposta')?.value || 0);
  const capacidadeTransporte = parseFloat(document.getElementById('capacidadeTransporte')?.value || 0);
  const coberturaCameras = parseFloat(document.getElementById('coberturaCameras')?.value || 0);
  const planoContingencia = parseFloat(document.getElementById('planoContingencia')?.value || 0);
  const equipes = document.getElementById('equipesEnvolvidas')?.value.toLowerCase() || "";

  const pesos = {
    publico: 0.4,
    efetivo: -0.3,
    ocorrencias: 0.25,
    clima: 0.2,
    rivalidade: 0.3,
    visitante: 0.2,
    infra: 0.2,
    evacuacao: 0.2,
    tempoResposta: 0.2,
    capacidadeTransporte: 0.2,
    coberturaCameras: 0.2,
    planoContingencia: 0.2,
    portoesAbertos: 0.2,
    bebidaAlcoolica: 0.3,
    tempoEvento: 0.2,
    setoresMistos: 0.3,
    conflitosHistoricos: 0.3,
    alertaSeguranca: 0.4,
    redesSociais: 0.3,
    eventoConcomitante: 0.2,
    distanciaTorcidas: 0.2,
    rivalExtra: 0.5
  };

  let z = 0;
  z += pesos.publico * (publico >= 50000 ? 1 : publico >= 20000 ? 0.5 : 0);
  z += pesos.efetivo * (efetivo < publico / 120 ? 1 : 0);
  z += pesos.ocorrencias * (ocorrencias > 3 ? 1 : ocorrencias > 1 ? 0.5 : 0);
  z += pesos.clima * clima;
  z += pesos.rivalidade * rivalidade;
  z += pesos.visitante * visitante;
  z += pesos.infra * infra;
  z += pesos.evacuacao * evacuacao;
  z += pesos.tempoResposta * tempoResposta;
  z += pesos.capacidadeTransporte * capacidadeTransporte;
  z += pesos.coberturaCameras * coberturaCameras;
  z += pesos.planoContingencia * planoContingencia;

  const treinamentoSeguranca = parseFloat(document.getElementById('treinamentoSeguranca')?.value || 0);
  const tempoInspecao = parseFloat(document.getElementById('tempoInspecao')?.value || 0);
  const eficienciaCheckpoints = parseFloat(document.getElementById('eficienciaCheckpoints')?.value || 0);
  const condicaoVias = parseFloat(document.getElementById('condicaoVias')?.value || 0);
  const iluminacaoPublica = parseFloat(document.getElementById('iluminacaoPublica')?.value || 0);
  const distanciaApoioPolicial = parseFloat(document.getElementById('distanciaApoioPolicial')?.value || 0);
  const diaSemana = parseFloat(document.getElementById('diaSemana')?.value || 0);
  const historicoEmocional = parseFloat(document.getElementById('historicoEmocional')?.value || 0);
  const monitoramentoGrupos = parseFloat(document.getElementById('monitoramentoGrupos')?.value || 0);
  const mandadosPendentes = parseFloat(document.getElementById('mandadosPendentes')?.value || 0);

  z += 0.2 * treinamentoSeguranca;
  z += 0.15 * tempoInspecao;
  z += 0.15 * eficienciaCheckpoints;
  z += 0.15 * condicaoVias;
  z += 0.15 * iluminacaoPublica;
  z += 0.15 * distanciaApoioPolicial;
  z += 0.1 * diaSemana;
  z += 0.2 * historicoEmocional;
  z += 0.2 * monitoramentoGrupos;
  z += 0.2 * mandadosPendentes;

  if ((equipes.includes("boca") && equipes.includes("river")) ||
      (equipes.includes("independiente") && equipes.includes("racing"))) {
    z += pesos.rivalExtra;
  }
  if (equipes.includes("corinthians") && equipes.includes("palmeiras")) {
    z += pesos.rivalExtra * 0.5;
  }

  const prob = 1 / (1 + Math.exp(-z));
  let resultado = "Baixo";
  let cor = "#4CAF50";
  if (prob >= 0.7) {
    resultado = "Alto";
    cor = "#F44336";
  } else if (prob >= 0.4) {
    resultado = "Moderado";
    cor = "#FFC107";
  }

  const el = document.getElementById("resultadoIA");
  el.innerText = `Previsão de Risco com IA: ${resultado} (Prob: ${(prob * 100).toFixed(1)}%)`;
  el.style.color = "white";
  el.style.backgroundColor = cor;
  el.style.padding = "10px";
  el.style.borderRadius = "6px";
}
</script>
</body>
</html>
